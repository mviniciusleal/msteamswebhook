# msteamswebhook

Send adaptative cards through teams webhook connector.

## Usage
 - [Setup teams webhook connector](https://docs.microsoft.com/en-us/microsoftteams/platform/webhooks-and-connectors/how-to/add-incoming-webhook)
 - Install the library running: ```pip install msteamswebhook```
 - Run the example code replacing the variable ```webhook_url``` with your own url generated by step 1.
## Example

This is a simple adaptative card:

```python
from msteamswebhook.msteams import Webhook
from msteamswebhook.base import *
from msteamswebhook.elements import *
from msteamswebhook.actions import *
from msteamswebhook.AdaptiveCard import AdaptiveCard

webhook_url = ""

elements = [
    ColumnSet(columns=[ 
        Column(
            verticalContentAlignment=VerticalContentAlignment.center,
            items=[
                TextBlock(
                    horizontalAlignment=HorizontalAlignment.left,                    
                    size=FontSize.large,
                    text="My Company",
                    isSubtle=True
                )
            ],
            width="stretch"
        ),
        Column(
            verticalContentAlignment=VerticalContentAlignment.center,
            items=[
                Image(
                    url="https://d500.epimg.net/cincodias/imagenes/2015/05/08/pyme/1431098283_691735_1431098420_noticia_normal.jpg",
                    width="80px"
                )
            ],
            width="auto"
        )
    ]),
    Container(
        separator=True,
        spacing=Spacing.medium,
        items=[
            TextBlock(size=FontSize.medium, weight=FontWeight.bolder, text="My report"),
            TextBlock(wrap=True, text="This is the report from 2021.")
        ]
    ),
    Container(
        style=ContainerStyle.emphasis, 
        items=[
            ColumnSet(
                columns=[
                    Column(
                        items=[
                            TextBlock(weight=FontWeight.bolder, text="Name")
                        ],
                        width="stretch"
                    ),
                    Column(
                        items=[
                            TextBlock(weight=FontWeight.bolder, text="Age")
                        ],
                        width="stretch"
                    ),
                    Column(
                        items=[
                            TextBlock(weight=FontWeight.bolder, text="City")
                        ],
                        width="stretch"
                    )
                ]
            )
        ]
    ),
    Container(
        items=[
            ColumnSet(
                spacing=Spacing.small,
                columns=[
                    Column(
                        items=[                        
                            TextBlock(text="Vinicius")
                        ],
                        width="stretch"
                    ),
                    Column(
                        items=[                        
                            TextBlock(text="30")
                        ],
                        width="stretch"
                    ),
                    Column(
                        items=[
                            TextBlock(text="Santiago")
                        ],
                        width="stretch"
                    )
                ]
            ),
                        ColumnSet(
                spacing=Spacing.small,
                columns=[
                    Column(
                        items=[
                            TextBlock(text="Roberto")
                        ],
                        width="stretch"
                    ),
                    Column(
                        items=[
                            TextBlock(text="37")
                        ],
                        width="stretch"
                    ),
                    Column(
                        items=[
                            TextBlock(text="Sao Paulo")
                        ],
                        width="stretch"
                    )
                ]
            ),
                        ColumnSet(
                spacing=Spacing.small,
                columns=[
                    Column(
                        items=[
                            TextBlock(text="Marcelo")
                        ],
                        width="stretch"
                    ),
                    Column(
                        items=[
                            TextBlock(text="20")
                        ],
                        width="stretch"
                    ),
                    Column(
                        items=[
                            TextBlock(text="Lima")
                        ],
                        width="stretch"
                    )
                ]
            )
        ]
    ),    
]
card = AdaptiveCard(elements)
Webhook.send_adaptative_card(card, webhook_url)
```


### Useful links
- https://amdesigner.azurewebsites.net/
- https://messagecardplayground.azurewebsites.net/
- https://adaptivecards.io/schemas/adaptive-card.json

